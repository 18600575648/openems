<div *ngIf="backend == 'openems'" fxLayout fxLayoutAlign="center start" fxLayoutWrap="wrap">
  <div *ngFor="let form of forms" fxFlex="50%" fxFlex.xs="100%">
    <form [formGroup]="form" (ngSubmit)="doLogin(form)">
      <md-card class="single">
        <md-card-header>
          <md-icon *ngIf="form._websocket.isConnected" md-card-avatar>face</md-icon>
          <md-icon *ngIf="!form._websocket.isConnected" md-card-avatar>pan_tool</md-icon>
          <md-card-title>{{form._websocket.name}}</md-card-title>
          <md-card-subtitle>{{form._websocket.url}}</md-card-subtitle>
        </md-card-header>
        <md-card-content fxLayout fxLayoutWrap="wrap">
          <md-input-container *ngIf="!form._websocket.isConnected" fxFlex="100%"><input formControlName="password" mdInput type="password" placeholder="Passwort"></md-input-container>
          <p fxFlex="100%">
            <ng-container *ngIf="!form._websocket.isConnected">Testversion: bitte melden Sie sich mit dem Passwort "<strong>admin</strong>" an.</ng-container> {{(form._websocket.event
            | async)?.message}}</p>
        </md-card-content>
        <md-card-actions fxLayout fxLayoutAlign="end start">
          <button type="submit" md-fab *ngIf="!form._websocket.isConnected" (click)="doLogin(form)" color="primary"><md-icon>check</md-icon></button>
          <button type="button" md-fab *ngIf="form._websocket.isConnected" (click)="doLogout(form)" color="accent"><md-icon>close</md-icon></button>
        </md-card-actions>
      </md-card>
    </form>
    <ng-container *ngFor="let dev of form._websocket.devices | keys">
      <md-card class="single" routerLink="/device/{{ form._websocket.name }}/{{ dev.key }}">
        <md-card-header>
          <md-icon *ngIf="dev.value.online" md-card-avatar color="primary">folder</md-icon>
          <md-icon *ngIf="!dev.value.online" md-card-avatar>error</md-icon>
          <md-card-title>{{ dev.key }} <span *ngIf="!dev.value.online"><br/>FEMS ist offline!</span></md-card-title>
          <md-card-subtitle>{{ form._websocket.name }}</md-card-subtitle>
        </md-card-header>
      </md-card>
    </ng-container>
  </div>
</div>

<div *ngIf="backend == 'femsserver'" fxLayout fxLayoutAlign="center start" fxLayoutWrap="wrap">
  <div *ngFor="let form of forms" fxFlex="50%" fxFlex.xs="100%">
    <form [formGroup]="form" (ngSubmit)="doLogin(form)">
      <md-card class="single">
        <md-card-header>
          <md-icon *ngIf="form._websocket.isConnected" md-card-avatar>play_arrow</md-icon>
          <md-icon *ngIf="!form._websocket.isConnected" md-card-avatar>stop</md-icon>
          <md-card-title>{{form._websocket.name}}</md-card-title>
          <md-card-subtitle>{{form._websocket.url}}</md-card-subtitle>
        </md-card-header>
        <md-card-content fxLayout fxLayoutWrap="wrap">
          <p fxFlex="100%">{{(form._websocket.event | async)?.message}}</p>
        </md-card-content>
      </md-card>
    </form>
  </div>
</div>