<html>

<head>
    <script src="https://d3js.org/d3.v4.js"></script>
</head>

<body>
    <div id="chart"></div>
    <script>

        function deg2rad(value) {
            return value * (Math.PI / 180)
        }

        var width = 1200;
        var height = 500;
        var radius = Math.min(width, height) / 2;
        var outerRadius = radius;
        var innerRadius = radius - 30;

        var dataset = [
            { label: 'Abulia', count: 10 },
            { label: 'Betelgeuse', count: 20 },
            { label: 'Cantaloupe', count: 30 },
            { label: 'Dijkstra', count: 40 }
        ];

        var color = d3.scaleOrdinal(d3.schemeCategory20b);

        var svg = d3.select('#chart')
            .append('svg')
            .attr('width', width)
            .attr('height', height)
            .append('g')
            .attr('transform', 'translate(' + (width / 2) + ',' + (height / 2) + ')');

        svg.append('path')
            .attr('d', d3.arc()
                .innerRadius(outerRadius)
                .outerRadius(innerRadius)
                .startAngle(deg2rad(226))
                .endAngle(deg2rad(314)))
            .attr('fill', 'white')
            .attr('stroke', 'LightGray');

        var grid =
            svg.append('path')
                .attr('d', d3.arc()
                    .innerRadius(outerRadius)
                    .outerRadius(innerRadius)
                    .startAngle(deg2rad(226))
                    .endAngle(deg2rad(250)))
                .attr('fill', 'grey');

        svg.append('path')
            .attr('d', d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(outerRadius)
                .startAngle(deg2rad(316))
                .endAngle(deg2rad(404)))
            .attr('fill', 'white')
            .attr('stroke', 'LightGray');

        var prod =
            svg.append('path')
                .attr('d', d3.arc()
                    .innerRadius(innerRadius)
                    .outerRadius(outerRadius)
                    .startAngle(deg2rad(316))
                    .endAngle(deg2rad(390)))
                .attr('fill', 'grey');

        svg.append('path')
            .attr('d', d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(outerRadius)
                .startAngle(deg2rad(46))
                .endAngle(deg2rad(134)))
            .attr('fill', 'white')
            .attr('stroke', 'LightGray');

        var cons =
            svg.append('path')
                .attr('d', d3.arc()
                    .innerRadius(innerRadius)
                    .outerRadius(outerRadius)
                    .startAngle(deg2rad(46))
                    .endAngle(deg2rad(90)))
                .attr('fill', 'grey');

        svg.append('path')
            .attr('d', d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(outerRadius)
                .startAngle(deg2rad(136))
                .endAngle(deg2rad(224)))
            .attr('fill', 'white')
            .attr('stroke', 'LightGray');

        function getArc(base, percentage) {
            return d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(outerRadius)
                .startAngle(deg2rad(base))
                .endAngle(deg2rad(base + battery))();
        }

        var battery = 80;

        var battArc = svg.append('path')
            .attr('d', getArc(136, battery))
            .attr('fill', 'grey');

        svg.append("svg:image")
            .attr('x', -9)
            .attr('y', -12)
            .attr('width', 20)
            .attr('height', 24)
            .attr("xlink:href", "src/favicon.ico");

        svg.append('text')
            .attr("x", -10)
            .attr("y", 50)
            .text("Hallo Welt")
            .attr("font-family", "sans-serif")
            .attr("font-size", "20px")
            .attr("fill", "red");

        setTimeout(function () {
            var battery = 10;
            //battArc.attr('d', getArc(136, battery));
            battArc.attr("d", d3.arc()
                .innerRadius(innerRadius)
                .outerRadius(outerRadius)
                .startAngle(deg2rad(136))
                .endAngle(deg2rad(136 + battery)));
        }, 1000);

    </script>
</body>